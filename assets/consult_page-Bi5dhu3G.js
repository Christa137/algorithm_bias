import{_ as L}from"./PageLayout-wVpgxbnR.js";import{s as v,A as U,K as n,D as B,J as i,L as e,h as s,M as o,H as S,Q as V,F as D,O as M,R as z,S as k,N as g,P as x,T as A,U as N}from"./index-BrTml2Fb.js";import{V as $,a as F}from"./VFooter-DZSFhVtD.js";import{_ as K,j as h,r as d,t as I,v as T,w as P}from"./VContainer-27DPJaY0.js";import{b as j,V as H,a as E,c as J}from"./VAppBar-cBfAJn_8.js";import{V as O,c as Q,d as R}from"./VCard-5mUneJXI.js";import{V as X,a as C}from"./VList-DaZ_f4gr.js";import{V as q}from"./VTextField-DDRmobaA.js";import{V as G}from"./VCol-CwX0XoVG.js";const W={class:"message-content"},Y={class:"text-body-1"},Z={class:"text-caption text-medium-emphasis mt-1 text-right"},ee={__name:"consult_page",setup(te){const u=v([{content:"您好！请发送消息，我会尽力为您提供帮助。",isUser:!1,timestamp:new Date().toLocaleTimeString()}]),l=v(""),r=v(!1),m=v(null),_=async()=>{await B(),m.value&&m.value.$el.scrollTo({top:m.value.$el.scrollHeight,behavior:"smooth"})},w=async()=>{var c,a,p,b;if(!l.value.trim())return;const y={content:l.value,isUser:!0,timestamp:new Date().toLocaleTimeString()};u.value.push(y);const t=l.value;l.value="",await _(),r.value=!0;try{const f=await F.post("https://api.deepseek.com/v1/chat/completions",{messages:[{role:"system",content:"你是一位专业法律顾问，用中文回答法律问题"},{role:"user",content:t}],model:"deepseek-chat",temperature:.02,max_tokens:1e3},{headers:{Authorization:"Bearer sk-03b7d3c94bcc432ea14c45b2d501c58f","Content-Type":"application/json"}});(b=(p=(a=(c=f.data)==null?void 0:c.choices)==null?void 0:a[0])==null?void 0:p.message)!=null&&b.content&&u.value.push({content:f.data.choices[0].message.content,isUser:!1,timestamp:new Date().toLocaleTimeString()})}catch(f){u.value.push({content:`请求失败：${f.message}`,isUser:!1,timestamp:new Date().toLocaleTimeString()})}finally{r.value=!1,await _()}};return U(_),(y,t)=>{const c=L;return i(),n(c,null,{default:e(()=>[s(j,{flat:"",color:"primary",dark:"",class:"app-bar",height:"80",elevation:4},{default:e(()=>[s(H,{color:"transparent",class:"pt-2"},{default:e(()=>[s(h,{icon:"",onClick:t[0]||(t[0]=a=>y.$router.go(-1)),class:"mr-2"},{default:e(()=>[s(d,{size:"32",color:"white"},{default:e(()=>t[2]||(t[2]=[o("mdi-arrow-left-circle")])),_:1})]),_:1}),s(E,{class:"text-h5 font-weight-bold white--text"},{default:e(()=>[t[4]||(t[4]=o(" 咨询客服 ")),s(d,{right:"",dark:"",class:"ml-2"},{default:e(()=>t[3]||(t[3]=[o("mdi-currency-usd")])),_:1})]),_:1})]),_:1})]),_:1}),s(I,{class:"py-8"},{default:e(()=>[s(O,{class:"chat-container mx-auto",elevation:"6","max-width":"800"},{default:e(()=>[s(Q,{class:"message-window pa-4"},{default:e(()=>[s(X,{class:"message-list",ref_key:"messageList",ref:m},{default:e(()=>[(i(!0),S(D,null,M(u.value,(a,p)=>(i(),n(J,{key:p},{default:e(()=>[s(C,{class:k(["message-item",{"user-message":a.isUser}]),style:z({flexDirection:a.isUser?"row-reverse":"row"})},{default:e(()=>[a.isUser?V("",!0):(i(),n(T,{key:0,color:"primary",class:"mr-4",size:"40"},{default:e(()=>[s(d,{dark:""},{default:e(()=>t[5]||(t[5]=[o("mdi-robot-happy")])),_:1})]),_:1})),a.isUser?(i(),n(T,{key:1,color:"secondary",class:"ml-4",size:"40"},{default:e(()=>[s(d,{dark:""},{default:e(()=>t[6]||(t[6]=[o("mdi-account")])),_:1})]),_:1})):V("",!0),g("div",W,[g("div",{class:k(["message-bubble",{"user-bubble":a.isUser}])},[g("div",Y,x(a.content),1),g("div",Z,x(a.timestamp),1)],2)])]),_:2},1032,["class","style"])]),_:2},1024))),128)),r.value?(i(),n(C,{key:0},{default:e(()=>[s(P,{indeterminate:"",color:"primary"})]),_:1})):V("",!0)]),_:1},512)]),_:1}),s(R,{class:"input-area pa-4"},{default:e(()=>[s(q,{modelValue:l.value,"onUpdate:modelValue":t[1]||(t[1]=a=>l.value=a),variant:"outlined",label:"输入你的消息或商品+价格","hide-details":"",onKeydown:A(N(w,["prevent"]),["enter"]),disabled:r.value},null,8,["modelValue","onKeydown","disabled"]),s(h,{color:"primary",class:"ml-4",onClick:w,disabled:!l.value||r.value,loading:r.value},{default:e(()=>[s(d,null,{default:e(()=>t[7]||(t[7]=[o("mdi-send")])),_:1}),t[8]||(t[8]=o(" 发送 "))]),_:1},8,["disabled","loading"])]),_:1})]),_:1})]),_:1}),s($,{padless:"",color:"grey darken-3",class:"white--text text-center"},{default:e(()=>[s(G,{class:"py-2"},{default:e(()=>t[9]||(t[9]=[o("咨询客服 © 2025")])),_:1})]),_:1})]),_:1})}}},me=K(ee,[["__scopeId","data-v-072de259"]]);export{me as default};
